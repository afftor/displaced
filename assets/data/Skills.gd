extends Node
#var S_Skill = preload("res://files/scripts/short_skill.gd");
# {code = 'sfx_aegis', target = 'target', period = 'predamage'}
#Guide for effects system is at the end of the file

var skilllist = {
	#new part
	attack = {
		code = '',#set in _ready()
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/action_1.png"),
		damagetype = "weapon",
		skilltype = 'skill',
		userange = "weapon",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'default'],
		value = ['caster.damage'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'},
		{code = 'anim_hit', target = 'target', period = 'postdamage'},
		{code = 'sfx_hit', target = 'target', period = 'predamage'}],
		patches = [
			{conditions = [{type = 'id', value = 'rose', check = true}], patch = 'p_base_rose'},
			{conditions = [{type = 'id', value = 'erika', check = true}], patch = 'p_base_erika'},
		], #while it is completely functional 'as is', we should either clone this skill or make a complex patches system to reflect element and range changes in sound and sfx data (or change current sfx code to use 'weapon_sfx' or 'element_sfx' placeholder)
		ai_priority = 1,
		sounddata = {predamage = 'weapon'},#postdamage = 'bodyhitsound'
	},
	defence = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/action_2.png"),
		damagetype = "",
		skilltype = 'skill',
		userange = "weapon",
		targetpattern = 'single',
		allowedtargets = ['self'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = [],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_defence'})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_block', target = 'caster', period = 'predamage'},],
		patches = [],
		ai_priority = 0
	},
	fire_attack_cast = {
		code = '',
		name = "",
		description = "",
		damagetype = "fire",
		skilltype = 'skill',
		userange = "weapon",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_cast', target = 'caster', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_firepunch', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {cast = 'firebolt'},
		ai_priority = 1
	},
	fire_attack = { # demon2 and others doesn't have cast animation so I need to do anim_attack instead of anim_cast
		code = '',
		name = "",
		description = "",
		damagetype = "fire",
		skilltype = 'skill',
		userange = "weapon",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_firepunch', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		ai_priority = 1,
		sounddata = {cast = 'firebolt'}
	},
	fire_attack_small = { #the same skill for the time being, but with smaller sfx sprite 
		code = '',
		name = "",
		description = "",
		damagetype = "fire",
		skilltype = 'skill',
		userange = "weapon",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_firepunch_fairy', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		ai_priority = 1,
		sounddata = {cast = 'firebolt'}
	},
	earth_attack = {
		code = '',
		name = "",
		description = "",
		damagetype = "earth",
		skilltype = 'skill',
		userange = "weapon",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_earth_strike', target = 'target', period = 'predamage', flip_h = true},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'}],
		patches = [],
		sounddata = {predamage = 'earth_strike'},
		ai_priority = 1
	},
	air_attack = {
		code = '',
		name = "",
		description = "",
		damagetype = "air",
		skilltype = 'skill',
		userange = "weapon",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_gustofwind', target = 'target', period = 'predamage', flip_h = true},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'}],
		patches = [],
		sounddata = {cast = 'gust of wind'},
		ai_priority = 1
	},
	dark_attack = {
		code = '',
		name = "",
		description = "",
		damagetype = "dark",
		skilltype = 'skill',
		userange = "weapon",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_dark_orb', target = 'target', period = 'predamage', flip_h = true},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'}],
		patches = [],
		sounddata = {cast = 'dark orb'},
		ai_priority = 1
	},
	light_attack = {
		code = '',
		name = "",
		description = "",
		damagetype = "light",
		skilltype = 'skill',
		userange = "weapon",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_holy_light', target = 'target', period = 'predamage', flip_h = true},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'}],
		patches = [],
		sounddata = {predamage = 'holy light'},
		ai_priority = 1
	},
	pierce_attack = {
		code = '',
		name = "",
		description = "",
		damagetype = "pierce",
		skilltype = 'skill',
		userange = "weapon",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_lunge', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {predamage = 'lunge'},
		ai_priority = 1
	},
#	fire_aoe = {
#		code = '',
#		name = "",
#		description = "",
#		damagetype = "fire",
#		skilltype = 'skill',
#		userange = "any",
#		targetpattern = 'all',
#		allowedtargets = ['enemy'],
#		keep_target = variables.TARGET_KEEP,
#		reqs = [],
#		tags = ['damage', 'aoe'],
#		value = ['caster.damage'],
#		cooldown = 0,
#		casteffects = [],
#		repeat = 1,
#		hidden = false,
#		sfx = [],
#		patches = [],
#		ai_priority = 0.7
#	},
	earth_aoe = {
		code = '',
		name = "",
		description = "",
		damagetype = "earth",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'aoe'],
		value = ['caster.damage'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'sfx_earthquake', target = 'target_group', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'}],
		patches = [],
		sounddata = {cast = 'earthquake'},
		ai_priority = 0.7
	},
#	fire_2_rand = {
#		code = '',
#		name = "",
#		description = "",
#		damagetype = "fire",
#		skilltype = 'skill',
#		userange = "weapon",
#		targetpattern = 'single',
#		allowedtargets = ['enemy'],
#		keep_target = variables.TARGET_NOKEEP,
#		next_target = variables.NT_ANY,
#		reqs = [],
#		tags = ['damage'],
#		value = ['caster.damage'],
#		cooldown = 0,
#		casteffects = [],
#		repeat = 2,
#		hidden = false,
#		sfx = [],
#		patches = [],
#		ai_priority = 0.7
#	},
	
	
	#-----------------heroes' skills--------------
	fencing = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/arron_7.png"),
		damagetype = "slash",
		skilltype = 'main',#set to reqired type
		userange = "melee",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		next_target = variables.NT_WEAK_MELEE,
		reqs = [],
		tags = ['damage', 'empty_target'],
		value = ['caster.damage', '*0.65'],
		cooldown = 0,
		casteffects = [],
		repeat = 3,
		hidden = false,
		sfx = [#{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'effected'},
			{code = 'sfx_hit', target = 'target', period = 'cast'},
			{code = 'anim_attack', target = 'caster', period = 'predamage'},
			],
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 3, op = 'lte'}], patch = 'p_fencing_1'},
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 4, op = 'eq'}], patch = 'p_fencing_2'},
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 3, op = 'lte'}], patch = 'p_fencing_3'},
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 4, op = 'eq'}], patch = 'p_fencing_4'},
		],
		sounddata = {cast = 'dodge', postdamage = 'fencing'},
	},
	lunge = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/arron_3.png"),
		damagetype = "pierce",
		skilltype = 'main',
		userange = "melee",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		next_target = variables.NT_MELEE,
		reqs = [],
		tags = ['damage'],
		value = [['caster.damage', '*0.5'], ['caster.damage', '*1.2']],
		damagestat = ['no_stat', '+damage_hp'],
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_bleed_onget', duration = 3, push_value = true})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_lunge', target = 'target', period = 'predamage'}],
		sounddata = {predamage = 'lunge'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 3, op = 'gte'}], patch = 'p_lunge'},
		]
	},
	sideslash = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/arron_8.png"),
		damagetype = "dark",
		skilltype = 'main',
		userange = "melee",
		targetpattern = 'sideslash',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		next_target = variables.NT_WEAK_MELEE,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage', '*1.1'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_side_slash', target = 'target', period = 'predamage'}],
		sounddata = {predamage = 'side slash'},
	},
	swift_s = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/arron_1.png"),
		damagetype = "air",
		skilltype = 'support',
		userange = "melee",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		next_target = variables.NT_MELEE,
		reqs = [],
		tags = ['damage'],
		value = [['caster.damage', '*1.2']],
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_swift'})],
		custom_duration = 1,
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_swift_s', target = 'target', period = 'predamage'}],
		sounddata = {predamage = 'swift strike13'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 3, op = 'gte'}], patch = 'p_swift_1'}
		]
	},
	parry = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/arron_2.png"),
		damagetype = "weapon",
		skilltype = 'support',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['ally'],
		keep_target = variables.TARGET_KEEP,
		next_target = variables.NT_MELEE,
		reqs = [],
		tags = ['buff'],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 1,
		casteffects = ['e_s_protect'],
		custom_duration = 1,
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_parry', target = 'target', period = 'predamage'},
		{code = 'anim_attack', target = 'caster', period = 'cast'},],
		sfx_duration = 0.3,
		sounddata = {postdamage = 'arron_parry'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 2, op = 'gte'}], patch = 'p_parry_1'}
		],
	},
	sword_mastery = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/arron_4.png"),
		damagetype = "weapon",
		skilltype = 'support',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['self'],
		keep_target = variables.TARGET_KEEP,
		next_target = variables.NT_MELEE,
		reqs = [],
		tags = ['buff'],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 1,
		casteffects = ['e_s_swordmas'],
		custom_duration = 1,
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_fencing', target = 'target', period = 'predamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'}],
		sounddata = {cast = 'sword mastery'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 2, op = 'gte'}], patch = 'p_swm_1'}
		]
	},
	termination = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/arron_5.png"),
		damagetype = "slash",
		skilltype = 'ultimate',
		userange = "melee",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		next_target = variables.NT_MELEE,
		reqs = [],
		tags = ['damage'],
		value = [['caster.damage', '*1.25']],
		cooldown = 10,
		casteffects = ['e_s_termination'],
		repeat = 4,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'effected'},
			{code = 'anim_ultimate', target = 'caster', period = 'cast'},
			{code = 'sfx_fight_arron_combo_sq', target = 'target', period = 'postcast'}],
		sounddata = {postdamage = 'termination'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 4, op = 'gte'}], patch = 'p_term_1'}
		],
#		follow_up = 'term1'
	},
#	term1 = {
#		code = '',
#		name = "",
#		description = "",
#		description_patch = [],
#		damagetype = "slash",
#		skilltype = 'ultimate',
#		userange = "melee",
#		targetpattern = 'single',
#		allowedtargets = ['enemy'],
#		keep_target = variables.TARGET_KEEP,
#		next_target = variables.NT_WEAK_MELEE,
#		reqs = [],
#		tags = ['damage'],
#		value = [['caster.damage', '*1.25']],
#		cooldown = 10,
#		repeat = 3,
#		casteffects = [],
#		hidden = false,
#		sfx = [],
#		sounddata = {postdamage = 'termination'},
#		patches = [{conditions = [{type = 'gear_level', slot = 'weapon1', level = 4, op = 'gte'}], patch = 'p_term_1'}],
#		not_final = true
#	},
	smoke_s = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/arron_6.png"),
		damagetype = "magic",
		skilltype = 'ultimate',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['ally', 'self'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['magic'],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 10,
		chance = 100,
		evade = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_smoke'})],
		hidden = false,
		sfx = [{code = 'sfx_smoke_screen', target = 'target', period = 'predamage'},
			{code = 'anim_ultimate', target = 'caster', period = 'cast'}],
		sounddata = {cast = 'smoke screen'},
		patches = [{conditions = [{type = 'gear_level', slot = 'weapon2', level = 4, op = 'eq'}], patch = 'p_smoke_screen'}],
	},
	swipe = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/rose_1.png"),
		damagetype = "slash",
		skilltype = 'main',
		userange = "melee",
		targetpattern = 'single',
		allowedtargets = ['enemy', 'damage'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['magic'],
		value = ['caster.damage','*0.8'],
		cooldown = 0,
		chance = 100,
		evade = 0,
		casteffects = ['e_s_swipe'],
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_rose_swipe', target = 'target', period = 'predamage'}], #still think it not match her weapon
		sounddata = {predamage = 'swipe'},
	},
	fire_bolt = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/rose_4.png"),
		damagetype = "fire",
		skilltype = 'main',
		userange = "any",
		targetpattern = 'row',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		next_target = variables.NT_MELEE,
		reqs = [],
		tags = ['damage'],
		value = [['caster.damage', '*0.5'], ['caster.damage']],
		damagestat = ['no_stat', '+damage_hp'],
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_burn_onget', push_value = true})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_firebolt', target = 'target', period = 'predamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},],
		sounddata = {cast = 'firebolt'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 3, op = 'lte'}], patch = 'p_fbolt_1'},
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 4, op = 'eq'}], patch = 'p_fbolt_2'},
		]
	},
	flash = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/rose_2.png"),
		damagetype = "light",
		skilltype = 'main',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['magic', 'damage'],
		value = ['caster.damage','*0.3'],
		cooldown = 2,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_flash'})],
		hidden = false,
		sfx = [{code = 'sfx_flash', target = 'target_group', period = 'predamage'},
		{code = 'anim_attack', target = 'caster', period = 'cast'}],
		sounddata = {cast = 'flash'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 3, op = 'eq'}], patch = 'p_flash_1'},
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 4, op = 'eq'}], patch = 'p_flash_2'},
		]
	},
	deluge = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/rose_5.png"),
		damagetype = "water",
		skilltype = 'support',
		userange = "any",
		targetpattern = 'line',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['magic', 'damage', 'debuff'],
		value = ['caster.damage','*0.8'],
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_t_deluge'})],
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_fight_rouz_9_water_sq', target = 'target', period = 'predamage'}],
		sounddata = {predamage = 'deluge'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 3, op = 'gte'}], patch = 'p_deluge'},
		]
	},
	renew = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/rose_8.png"),
		damagetype = "",
		skilltype = 'support',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['ally', 'self'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['heal', 'buff'],
		value = [['target.hpmax','*0.25'],['target.hpmax','*0.35']],
		damagestat = ['no_stat', '-damage_hp'],
		cooldown = 2,
		chance = 100,
		evade = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_renew', push_value = true})],
		hidden = false,
		sfx = [{code = 'targetfire', target = 'target', period = 'postdamage'},
			{code = 'sfx_soul_prot', target = 'target', period = 'predamage'},
			{code = 'anim_special', target = 'caster', period = 'cast'},],
		sounddata = {cast = 'renew'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 3, op = 'lte'}], patch = 'p_renew_1'},
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 4, op = 'eq'}], patch = 'p_renew_2'},
		]
	},
	dispel = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/rose_3.png"),
		damagetype = "magic",
		skilltype = 'support',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['ally', 'self'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['magic'],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 1,
		chance = 100,
		evade = 0,
		casteffects = ['e_s_dispel'],
		hidden = false,
		sfx = [{code = 'targetfire', target = 'target', period = 'postdamage'},
			{code = 'sfx_dispel', target = 'target', period = 'predamage'},
			{code = 'anim_special', target = 'caster', period = 'cast'},],
		sounddata = {cast = 'dispel'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 2, op = 'gte'}], patch = 'p_dispel'}
		]
	},
	explosion = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/rose_7.png"),
		damagetype = "fire",
		skilltype = 'ultimate',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage','*2.0'],
		cooldown = 10,
		casteffects = [],
		hidden = false,
		sfx = [{code = 'anim_ultimate', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_explosion', target = 'target_group', period = 'postcast'}],
		sounddata = {postcast = 'explosion'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 4, op = 'gte'}], patch = 'p_explosion'}
		]
	},
	protect = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/rose_6.png"),
		damagetype = "magic",
		skilltype = 'ultimate',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['ally', 'self'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['magic', 'buff'],
		value = ['caster.damage', '*3'],
		damagestat = ['+shield'],
		cooldown = 10,
		chance = 100,
		evade = 0,
		casteffects = ['e_s_dispel', Effectdata.rebuild_template({effect = 'common_shield_info'})],
		hidden = false,
		sfx = [{code = 'sfx_rose_protection', target = 'target', period = 'predamage'},
			{code = 'anim_ultimate', target = 'caster', period = 'cast'},
		],
		sounddata = {predamage = 'protection'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 4, op = 'gte'}], patch = 'p_protect'}
		]
	},
	protect1 = {
		code = '',
		name = "",
		description = "",
		damagetype = "magic",
		skilltype = 'spell',
		userange = "any",
		targetpattern = 'no_target',
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		allowedtargets = ['ally', 'self'],
		reqs = [],
		tags = ['magic', 'buff'],
		value = ['caster.damage'],
		damagestat = ['+shield'],
		cooldown = 0,
		chance = 100,
		evade = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'common_shield_info'})],
		hidden = false,
		sfx = [{code = 'sfx_rose_protection', target = 'target', period = 'predamage'}],
		sounddata = {predamage = 'protection'},
		not_final = true
	},
	qshot = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/erika_6.png"),
		damagetype = "pierce",
		skilltype = 'main',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEPFIRST,
		next_target = variables.NT_ANY,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage', '*0.7'],
		cooldown = 0,
		repeat = 3,
		casteffects = [],
		hidden = false,
		sfx = [{code = 'sfx_arrow_shot', target = 'target', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'effected'},
			{code = 'anim_attack', target = 'caster', period = 'predamage'},],
		sounddata = {predamage = 'arrow_shot'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 3, op = 'gte'}], patch = 'p_qshot_1'},
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 3, op = 'lte'}], patch = 'p_qshot_2'},
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 4, op = 'eq'}], patch = 'p_qshot_3'},
		],
#		follow_up = 'qshot1'
	},
#	qshot1 = {
#		code = 'qshot1',
#		name = "",
#		description = "",
#		icon = load("res://assets/images/iconsskills/erika_6.png"),
#		damagetype = "pierce",
#		skilltype = 'main',
#		userange = "any",
#		targetpattern = 'single',
#		allowedtargets = ['enemy'],
#		keep_target = variables.TARGET_KEEPFIRST,
#		next_target = variables.NT_ANY,
#		reqs = [],
#		tags = ['damage'],
#		value = ['caster.damage', '*0.7'],
#		cooldown = 0,
#		casteffects = [],
#		repeat = 2,
#		hidden = false,
#		sfx = [],
##		sfxcaster = null,
##		sfxtarget = null,
#		sounddata = {predamage = 'arrow_shot'},
#		patches = [
#			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 3, op = 'gte'}], patch = 'p_qshot_1'},
#			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 3, op = 'lte'}], patch = 'p_qshot_2'},
#			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 4, op = 'eq'}], patch = 'p_qshot_3'},
#		],
#		not_final = true
#	},
	aarrow = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/erika_2.png"),
		damagetype = "air",
		skilltype = 'main',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'air', 'debuf'],
		value = ['caster.damage'],
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_t_aarrow'})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_arrow_air', target = 'target', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'},],
		sounddata = {predamage = 'air arrow'},#postdamage = 'bodyarmor'
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 3, op = 'lte'}], patch = 'p_aarrow_1'},
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 4, op = 'eq'}], patch = 'p_aarrow_2'},
		]
	},
	eastrike = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/erika_4.png"),
		damagetype = "earth",
		skilltype = 'main',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'earth'],
		value = ['caster.damage'],
		cooldown = 0,
		casteffects = ['e_t_eastrike'],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_earth_strike', target = 'target', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'},],
		sounddata = {predamage = 'earth_strike'},
		patches = []
	},
	frost_arrow = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/erika_5.png"),
		damagetype = "water",
		skilltype = 'support',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'water', 'debuff'],
		value = ['caster.damage', '*0.9'],
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_freeze', chance = 0.5})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_arrow_frost', target = 'target', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'},],
		sounddata = {cast = 'frost arrow'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 2, op = 'gte'}], patch = 'p_farrow_1'},
		]
	},
	arr_shower = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/erika_3.png"),
		damagetype = "pierce",
		skilltype = 'support',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['damage', 'aoe'],
		value = ['caster.damage','*0.6'],
		cooldown = 1,
		casteffects = [],
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_arrow_rain', target = 'target', period = 'predamage'}
		],
		sounddata = {cast = 'arrowshower'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 2, op = 'gte'}], patch = 'p_arrshower'}
		]
	},
	nat_bless = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/erika_1.png"),
		damagetype = "",
		skilltype = 'support',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['ally', 'self'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['buff'],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 5,
		chance = 100,
		evade = 0,
		casteffects = ['e_t_nat_bless_common'],
		hidden = false,
		sfx = [{code = 'sfx_nat_bless', target = 'target', period = 'predamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'},
			],
		sounddata = {cast = 'nature_blessing'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 3, op = 'gte'}], patch = 'p_natbless'}
			]
	},
#	nat_bless_pass = {
#		code = 'nat_bless',
#		name = "",
#		description = tr(""),
#		icon = load("res://assets/images/iconsskills/arrowshower.png"),
#		damagetype = "light",
#		skilltype = 'spell',
#		userange = "any",
#		targetpattern = 'all',
#		allowedtargets = ['ally', 'self'],
#		keep_target = variables.TARGET_KEEP,
#		repeat = 1,
#		reqs = [],
#		tags = ['buff'],
#		value = ['0'],
#		cooldown = 0,
#		chance = 100,
#		evade = 0,
##		manacost = 0,
#		casteffects = [Effectdata.rebuild_template({effect = 'e_s_nat_bless1'})],
#		hidden = false,
#		sfx = [{code = 'targetfire', target = 'target', period = 'postdamage'}],
#		sfxcaster = null,
#		sfxtarget = null,
#		sounddata = {cast = 'firebolt', postdamage = 'firehit'},
#		patches = [],
#		not_final = true,
#	},
	heartseeker = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/erika_7.png"),
		damagetype = "pure",
		skilltype = 'ultimate',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage', '*5'],
		cooldown = 10,
		casteffects = [Effectdata.rebuild_template({effect = 'e_stun', duration = 2})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_heartseeker', target = 'target', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_ultimate', target = 'caster', period = 'predamage'},],
		sounddata = {cast = 'heart_seeker'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 4, op = 'gte'}], patch = 'p_hearts'},
		]
	},
	charm = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/erika_8.png"),
		damagetype = "magic",
		skilltype = 'ultimate',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['magic', 'debuff'],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 10,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_charm'})],
		hidden = false,
		sfx = [{code = 'sfx_charm', target = 'target', period = 'predamage'},
			{code = 'anim_ultimate', target = 'caster', period = 'cast'}],
		sounddata = {predamage = 'charm'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 4, op = 'gte'}], patch = 'p_charm'},
		]
	},
	combo = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/ember_5.png"),
		damagetype = "bludgeon",
		skilltype = 'main',
		userange = "melee",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		next_target = variables.NT_BACK,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage', '*0.65'],
		cooldown = 0,
		repeat = 3,
		casteffects = [],#'e_tr_enable_fa'
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'effected'},
			{code = 'sfx_combo', target = 'target', period = 'cast'}],
		sounddata = {postdamage = 'punch'},#'swift strike12' in cast works well with 'anim_hit' on cast
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 3, op = 'lte'}], patch = 'p_combo_1'},
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 4, op = 'eq'}], patch = 'p_combo_2'},
		],
	},
	firepunch = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/ember_4.png"),
		damagetype = "fire",
		skilltype = 'main',
		userange = "melee",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		next_target = variables.NT_MELEE,
		reqs = [],
		tags = ['damage'],
		value = [['caster.damage', '*0.5'],['caster.damage']],
		damagestat = ['no_stat', '+damage_hp'],
		cooldown = 0,
		casteffects = ['e_t_punch1', 'e_t_punch2'],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_firepunch', target = 'target', period = 'predamage'}],
		sounddata = {predamage = 'punch'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 2, op = 'gte'}], patch = 'p_punch_1'}
		]
	},
	shockwave = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/ember_3.png"),
		damagetype = "earth",
		skilltype = 'main',
		userange = "melee",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage', '*0.9'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_shockwave', target = 'target', period = 'predamage'}],
		sounddata = {predamage = 'shockwave'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 2, op = 'gte'}], patch = 'p_shockwave'},
		],
		follow_up = 'shockwave1'
	},
	shockwave1 = {
		code = '',
		name = "",
		description = "",
		damagetype = "earth",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'neighbours',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'empty_target', 'no_refine'],
		value = ['caster.damage', '*0.45'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = true,
		sfx = [{code = 'anim_hit', target = 'target', period = 'postdamage'}],
		sounddata = {cast = 'shockwave'},
		patches = [],
		not_final = true
	},
	uppercut = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/ember_1.png"),
		damagetype = "air",
		skilltype = 'support',
		userange = "melee",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'air', 'debuf'],
		value = ['caster.damage'],
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_uppercut'})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'predamage'},
		{code = 'anim_hit', target = 'target', period = 'postdamage'},
		{code = 'sfx_uppercut', target = 'target', period = 'predamage'}],
		sounddata = {predamage = 'uppercut'},
		patches = []
	},
	defend = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/ember_6.png"),
		damagetype = "",
		skilltype = 'support',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['self'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['buff'],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 2,
		chance = 100,
		evade = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_defend', trigger = variables.TR_CAST}),
			'e_s_protect_er'],
		hidden = false,
		sfx = [{code = 'sfx_shield_up', target = 'target', period = 'predamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'},],
		sounddata = {cast = 'defend'},#postdamage = 'bodyarmor'
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 3, op = 'lte'}], patch = 'p_defend_1'},
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 4, op = 'eq'}], patch = 'p_defend_2'},
		]
	},
	dragon_protection = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/ember_2.png"),
		damagetype = "",
		skilltype = 'support',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['self'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['buff'],
		value = ['caster.hpmax', '*0.25'],
		damagestat = 'no_stat',
		cooldown = 1,
		chance = 100,
		evade = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_t_dragonprot', push_value = true})],
		hidden = false,
		sfx = [{code = 'targetfire', target = 'target', period = 'postdamage'},
			{code = 'sfx_shield_up', target = 'target', period = 'predamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'},
		],
		sounddata = {cast = 'dragon protection'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 3, op = 'gte'}], patch = 'p_dragonprot'},
		]
	},
	aegis = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/ember_8.png"),
		damagetype = "",
		skilltype = 'ultimate',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['self'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['buff'],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 10,
		chance = 100,
		evade = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_aegis'})],
		hidden = false,
		sfx = [{code = 'sfx_aegis', target = 'target', period = 'predamage'},
			{code = 'anim_ultimate', target = 'caster', period = 'cast'}],
		sounddata = {cast = 'aegis'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 4, op = 'gte'}], patch = 'p_aegis'},
		]
	},
	earthquake = {
		code = '',
		name = '',
		description = '',
		description_patch = [],
		icon = load("res://assets/images/iconsskills/ember_7.png"),
		damagetype = "earth",
		skilltype = 'ultimate',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['damage', 'aoe'],
		value = ['caster.damage','*0.8'],
		cooldown = 10,
		casteffects = [],
		hidden = false,
		sfx = [{code = 'anim_ultimate', target = 'caster', period = 'cast'},
			{code = 'sfx_earthquake', target = 'target_group', period = 'postcast'},#it's better to make a separate earthquake animation to set up custom delay
			{code = 'anim_hit', target = 'target', period = 'postdamage'}],
		sounddata = {postcast = 'earthquake'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 4, op = 'gte'}], patch = 'p_eq'},
		],
		follow_up = 'eq1'#first cycle of skill had to be separate because of patch
	},
	eq1 = {
		code = '',
		name = "",
		description = '',
		damagetype = "earth",
		skilltype = 'spell',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		repeat = 3,
		reqs = [],
		tags = ['damage', 'aoe'],
		value = ['caster.damage','*0.8'],
		cooldown = 0,
		casteffects = [],
		hidden = false,
		sfx = [],
#		sounddata = {cast = 'earthquake'},
		patches = [],
		not_final = true
	},
	dark_orb = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/rilu_6.png"),
		damagetype = "dark",
		skilltype = 'main',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'debuff'],
		value = [['caster.damage', '*0.85']],
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_t_orb'})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_dark_orb', target = 'target', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'postdamage'},],
		sounddata = {predamage = 'dark orb'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 3, op = 'lte'}], patch = 'p_orb_1'},
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 4, op = 'eq'}], patch = 'p_orb_2'},
		]
	},
	pale_mist = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/rilu_3.png"),
		damagetype = "water",
		skilltype = 'main',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [{type = 'stats', stat = 'alt_mana', operant = 'gte', value = 1}],
		tags = ['damage', 'debuff', 'souls'],
		value = [['caster.damage', '*0.2']],
		cooldown = 0,
		casteffects = ['e_pay_soul', Effectdata.rebuild_template({effect = 'e_t_mist', push_value = true})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_pale_mist', target = 'target', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'},],
		sounddata = {predamage = 'pale mist'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 3, op = 'gte'}], patch = 'p_mist'},
		]
	},
	avalanche = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/rilu_1.png"),
		damagetype = "earth",
		skilltype = 'main',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_NOKEEP,
		next_target = variables.NT_ANY,
		reqs = [],
		tags = ['damage'],
		value = [['caster.damage', '*0.4']],
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_stun', duration = 1, chance = 0.2})],
		hidden = false,
		repeat = 5,
		sfx = [{code = 'sfx_avalanche', target = 'target', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'}], #the only period, that do not clone for each repeat 
		sounddata = {cast = 'avalanche'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 2, op = 'gte'}], patch = 'p_ava'}
		],
#		follow_up = 'avalanche1'
	},
#	avalanche1 = {
#		code = 'avalanche1',
#		name = "",
#		description = "",
#		icon = load("res://assets/images/iconsskills/rilu_1.png"),
#		damagetype = "earth",
#		skilltype = 'main',
#		userange = "any",
#		targetpattern = 'single',
#		allowedtargets = ['enemy'],
#		keep_target = variables.TARGET_NOKEEP,
#		next_target = variables.NT_ANY,
#		reqs = [],
#		tags = ['damage'],
#		value = [['caster.damage', '*0.4']],
#		cooldown = 0,
#		casteffects = [Effectdata.rebuild_template({effect = 'e_stun', duration = 1, chance = 0.2})],
#		repeat = 4,
#		hidden = false,
#		sfx = [], 
##		sfxcaster = null,
##		sfxtarget = null,
#		sounddata = {cast = 'avalanche'},
#		patches = [
#			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 2, op = 'gte'}], patch = 'p_ava'}
#		],
#		not_final = true
#	},
	soulthorns = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/rilu_7.png"),
		damagetype = "pierce",
		skilltype = 'support',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage'],
		cooldown = 0,
		casteffects = ['e_t_thorns'],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_spirit_thorn', target = 'target', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'},],
		sounddata = {cast = 'dark orb'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 2, op = 'gte'}], patch = 'p_thorn'},
		]
	},
	dark_echoes = {
		code = '',
		name = '',
		description = '',
		description_patch = [],
		icon = load("res://assets/images/iconsskills/rilu_8.png"),
		damagetype = "dark",
		skilltype = 'support',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['damage', 'aoe', 'taunt'],
		value = [['caster.hpmax', '*0.3'],['caster.damage','*0.6']],
		damagestat = ['no_stat', '+damage_hp'],
		cooldown = 1,
		casteffects = ['e_s_echo', Effectdata.rebuild_template({trigger = variables.TR_CAST, effect = 'e_echo_shield', push_value = true})],
		hidden = false,
		sfx = [{code = 'anim_special', target = 'caster', period = 'cast'},
			{code = 'sfx_dark_echoes', target = 'target', period = 'predamage'}, 
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_dark_echoes_1', target = 'caster', period = 'postdamage'}
		],
		sounddata = {cast = 'dispel'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 3, op = 'lte'}], patch = 'p_echo_1'},
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 4, op = 'eq'}], patch = 'p_echo_2'}
		]
	},
	restoration = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/rilu_2.png"),
		damagetype = "",
		skilltype = 'support',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['ally', 'self'],
		keep_target = variables.TARGET_KEEP,
		reqs = [{type = 'stats', stat = 'alt_mana', operant = 'gte', value = 1}],
		tags = ['heal', 'souls'],
		value = ['target.hpmax', '*0.2'],
		damagestat = '-damage_hp',
		cooldown = 1,
		casteffects = ['e_pay_soul'],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_resto', target = 'target', period = 'predamage'},
			{code = 'anim_special', target = 'caster', period = 'cast'},
		],
		sounddata = {cast = 'restoration'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 3, op = 'gte'}], patch = 'p_resto'},
		]
	},
	soul_beam = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/rilu_4.png"),
		damagetype = "light",
		skilltype = 'ultimate',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [{type = 'stats', stat = 'alt_mana', operant = 'gte', value = 1}],
		tags = ['damage', 'debuff', 'souls'],
		value = ['caster.damage', '*', ['caster.alt_mana', '*0.1', '+0.9']],
		cooldown = 10,
		casteffects = [
			'e_pay_all_souls',
			Effectdata.rebuild_template({effect = 'e_t_beam', trigger = variables.TR_HIT}),
			Effectdata.rebuild_template({effect = 'e_s_beam_debuff'})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_soul_beam', target = 'full', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_ultimate', target = 'caster', period = 'cast'},],
		sounddata = {predamage = 'sould beam'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 4, op = 'gte'}], patch = 'p_beam'},
		]
	},
	soul_prot = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/rilu_5.png"),
		damagetype = "",
		skilltype = 'ultimate',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['ally', 'self'],
		keep_target = variables.TARGET_KEEP,
		reqs = [{type = 'stats', stat = 'alt_mana', operant = 'gte', value = 1}],
		tags = ['heal', 'buff', 'souls'],
		value = ['target.hpmax', '*', ['caster.alt_mana', '*0.1']],
		damagestat = '-damage_hp',
		cooldown = 10,
		casteffects = ['e_pay_all_souls', Effectdata.rebuild_template({effect = 'e_t_soulprot'})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_soul_prot', target = 'target', period = 'predamage'},
			{code = 'anim_ultimate', target = 'caster', period = 'cast'},],
		sounddata = {cast = 'soul protection'},
		patches = []
	},
	holy_light = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/iola_4.png"),
		damagetype = "light",
		skilltype = 'main',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_holy_light', target = 'target', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'},],
		sounddata = {predamage = 'holy light'},
		patches = []
	},
	gustofwind = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/iola_3.png"),
		damagetype = "air",
		skilltype = 'main',
		userange = "any",
		targetpattern = 'line',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage','*0.6'],
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_gust1', chance = 0.4})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_gustofwind', target = 'target', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'},],
		sounddata = {cast = 'gust of wind'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 2, op = 'gte'}], patch = 'p_gust'},
		]
	},
	smash = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/iola_6.png"),
		damagetype = "bludgeon",
		skilltype = 'main',
		userange = "melee",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'debuf'],
		value = ['caster.damage','*0.8'],
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_stun', chance = 0.5, duration = 1})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_iola_swipe', target = 'target', period = 'predamage'}],
		sounddata = {predamage = 'smash'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 2, op = 'gte'}], patch = 'p_smash'},
		]
	},
	cleansing = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/iola_7.png"),
		damagetype = "fire",
		skilltype = 'support',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'dispel', 'fire'],
		value = [['caster.damage','*0.5'],['caster.damage','*0.9']],
		damagestat = ['no_stat', '+damage_hp'],
		cooldown = 1,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_cleanse'}), 'e_s_resetfire'],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_cleansing', target = 'target', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'},],
		sounddata = {predamage = 'cleansing'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 3, op = 'gte'}], patch = 'p_clean_1'},
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 3, op = 'gte'}], patch = 'p_clean_2'},
		]
	},
	barrier = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/iola_1.png"),
		damagetype = "",
		skilltype = 'support',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['ally', 'self'],
		keep_target = variables.TARGET_KEEPFIRST,
		next_target = variables.NT_CASTER,
		repeat = 1,
		reqs = [],
		tags = ['buff'],
		value = ['target.hpmax', '*0.5'],
		damagestat = ['no_stat'],
		cooldown = 1,
		casteffects = [Effectdata.rebuild_template({effect = 'e_t_iola_barrier', push_value = true})],
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'sfx_barrier', target = 'target', period = 'predamage'}],
		sounddata = {cast = 'barrier2'},#postdamage = 'bodyarmor'
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 3, op = 'lte'}], patch = 'p_barrier'},
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 4, op = 'eq'}], patch = 'p_barrier_all'},
		]
	},
	bless = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/iola_2.png"),
		damagetype = "",
		skilltype = 'support',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['self', 'ally'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['buff', 'heal'],
		value = ['caster.hpmax', '*0.5'],
		damagestat = '-damage_hp',
		cooldown = 2,
		chance = 100,
		evade = 0,
		casteffects = ['e_t_bless_caster', 'e_t_bless_others'],
		hidden = false,
		sfx = [{code = 'sfx_bless', target = 'target', period = 'predamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'},
		],
		sounddata = {cast = 'renew'},
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 3, op = 'lte'}], patch = 'p_bless_1'},
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 4, op = 'eq'}], patch = 'p_bless_2'},
		]
	},
	sanctuary = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/iola_8.png"),
		damagetype = "",
		skilltype = 'ultimate',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['ally', 'self', 'dead'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['heal', 'resurrect'],
		value = ['caster.hpmax', '*0.35'],
		damagestat = ['-damage_hp'],
		cooldown = 10,
		chance = 100,
		evade = 0,
		casteffects = ['e_s_sanct'],
		hidden = false,
		sfx = [{code = 'sfx_sanctuary', target = 'target', period = 'predamage'},
			{code = 'anim_ultimate', target = 'caster', period = 'cast'},
		],
		sounddata = {cast = 'sanctuary'},#postdamage = 'bodyarmor'
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon1', level = 4, op = 'gte'}], patch = 'p_sanct'},
		]
	},
	purge = {
		code = '',
		name = "",
		description = "",
		description_patch = [],
		icon = load("res://assets/images/iconsskills/iola_5.png"),
		damagetype = "",
		skilltype = 'ultimate',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['damage', 'debuff', 'dispel'],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 10,
		casteffects = [
			Effectdata.rebuild_template({effect = 'e_s_cleanse'}),
			Effectdata.rebuild_template({effect = 'e_silence', duration = 2})],
		hidden = false,
		sfx = [{code = 'anim_ultimate', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_purge', target = 'target', period = 'predamage'}
		],
		sounddata = {predamage = 'purge'},#postdamage = 'bodyarmor'
		patches = [
			{conditions = [{type = 'gear_level', slot = 'weapon2', level = 4, op = 'gte'}], patch = 'p_purge'},
		]
	},
	
	
	#-----------------enemies' skills--------------
	treant_summon = {
		code = '',
		name = "",
		description = "",
		damagetype = "summon",
		skilltype = 'spell',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['self'],
		keep_target = variables.TARGET_KEEP,
		reqs = [{type = 'stats', stat = 'ai_spec', operant = 'lt', value = 3}],
		tags = ['summon'],
		value = ['treant', [1, 2]],
		repeat = 1,
		cooldown = 3,
		casteffects = [],
		hidden = false,
		sfx = [ {code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'sfx_treant_summon', target = 'caster', period = 'predamage'},
			],
		sounddata = {cast = 'magic_effect'},
		patches = [],
		ai_priority = 1
	},
	dk_slash = {
		code = '',
		name = "",
		description = "",
		damagetype = "slash",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'aoe'],
		value = ['caster.damage', '*0.8'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'}, 
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_hit', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {cast = 'fencing'},
		ai_priority = 1
	},
	dk_strike = {
		code = '',
		name = "",
		description = "",
		damagetype = "earth",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage', '*1.5'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_earth_strike', target = 'target', period = 'predamage', flip_h = true},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'}],
		patches = [],
		sounddata = {predamage = 'earth_strike'},
		ai_priority = 1
	},
	dk_stun = {
		code = '',
		name = "",
		description = "",
		damagetype = "bludgeon",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEPFIRST,
		next_target = variables.NT_ANY_NOREPEAT,
		reqs = [],
		tags = ['damage', 'stun'],
		value = ['caster.damage', '*0.5'],
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_stun', chance = 0.2, duration = 1})],
		repeat = 2,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_iola_swipe', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {predamage = 'smash'},
		ai_priority = 1
	},
	dk_dark = {
		code = '',
		name = "",
		description = "",
		damagetype = "dark",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEPFIRST,
		next_target = variables.NT_ANY,
		reqs = [],
		tags = ['damage', 'dark'],
		value = ['caster.damage', '*0.9'],
		cooldown = 0,
		casteffects = [],
		repeat = 3,
		hidden = false,
		sfx = [{code = 'sfx_dark_orb', target = 'target', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'predamage'}],
		patches = [],
		sounddata = {postdamage = 'dark orb'},
		ai_priority = 1
	},
	dk_execute_charge = {
		code = '',
		name = "",
		description = "",
		damagetype = "dark",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['self'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['prepare'],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 2,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_execute_charge'})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_dark_echoes_1', target = 'caster', period = 'cast'}],
		patches = [],
		sounddata = {cast = 'dispel'},
		ai_priority = 1
	},
	dk_execute = {
		code = '',
		name = "",
		description = "",
		damagetype = "slash",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'charged'],
		value = [['caster.hpmax','*0.1'],['caster.damage', '*4']],
		damagestat = ['no_stat', '+damage_hp'],
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_execute_heal', push_value = true, trigger = variables.TR_CAST})],
		repeat = 1,
		hidden = true,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_fight_arron_combo_sq', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {postdamage = 'termination'},
		ai_priority = 100
	},
	fq_summon = {
		code = '',
		name = "",
		description = '',
		damagetype = "summon",
		skilltype = 'spell',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['self'],
		keep_target = variables.TARGET_KEEP,
		reqs = [{type = 'stats', stat = 'ai_spec', operant = 'lt', value = 3}],
		tags = ['summon'],
		value = ['faery', [1, 2]],
		repeat = 1,
		cooldown = 1,
		casteffects = [],
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'sfx_treant_summon', target = 'caster', period = 'predamage'}],
		sounddata = {cast = 'magic_effect'},
		patches = [],
		ai_priority = 10
	},
	fq_lance = {
		code = '',
		name = "",
		description = "",
		damagetype = "air",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'air'],
		value = ['caster.damage', '*1.2'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_gustofwind', target = 'target', period = 'predamage'},
			{code = 'sfx_impale', target = 'target', period = 'predamage', flip_h = true},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'}],
		patches = [],
		sounddata = {cast = 'gust of wind'},
		ai_priority = 1
	},
	fq_screech = {
		code = '',
		name = "",
		description = "",
		damagetype = "pierce",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage', '*0.6'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_target_fight_growl_sq', target = 'caster', period = 'predamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'}],
		patches = [],
		sounddata = {cast = 'queen fairy cast2'},
		ai_priority = 1
	},
	fq_flash = {
		code = '',
		name = "",
		description = "",
		damagetype = "light",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'debuff'],
		value = ['caster.damage', '*0.5'],
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_flash', chance = 0.5})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_holy_light', target = 'target', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'}],
		patches = [],
		sounddata = {cast = 'flash'},
		ai_priority = 1
	},
	fq_blast = {
		code = '',
		name = "",
		description = "",
		damagetype = "water",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'water'],
		value = ['caster.damage', '*',['caster.ai_spec','*-0.6','+3']],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_arrow_frost', target = 'target', period = 'predamage', flip_h = true},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'}],
		patches = [],
		sounddata = {cast = 'frost arrow'},
		ai_priority = 1
	},
	vic_fburst = {
		code = '',
		name = "",
		description = "",
		damagetype = "fire",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'aoe', 'burn'],
		value = [['caster.damage', '*0.4'],['caster.damage', '*0.5']],
		damagestat = ['no_stat', '+damage_hp'],
		cooldown = 2,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_burn', push_value = true})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_cast', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_firepunch', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {cast = 'firebolt'},
		ai_priority = 1
	},
	vic_culling = {
		code = '',
		name = "",
		description = "",
		damagetype = ['slash','fire','air'],
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage'],
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_viccull'})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_rose_swipe', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {predamage = 'swipe'},
		ai_priority = 1
	},
	en_enburst = {#victor & scientist
		code = '',
		name = "",
		description = "",
		damagetype = "dark",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'aoe'],
		value = [['caster.damage', '*0.5']],
		cooldown = 0,
		casteffects = ['e_tr_vicen'],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_cast', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_AOE_fight_blacklightning_storm_sq', target = 'target_group', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'magic_effect'},
		ai_priority = 1
	},
	en_thrust = {#victor & scientist
		code = '',
		name = "",
		description = "",
		damagetype = 'pierce',
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage','*1.3'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_spirit_thorn', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {predamage = 'lunge'},
		ai_priority = 1
	},
	sc_summon = {
		code = '',
		name = "",
		description = '',
		damagetype = "summon",
		skilltype = 'spell',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['self'],
		keep_target = variables.TARGET_KEEP,
		reqs = [{type = 'stats', stat = 'ai_spec', operant = 'lt', value = 3}],
		tags = ['summon'],
		value = ['bomber', [1, 2]],
		repeat = 1,
		cooldown = 2,
		casteffects = [],
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'sfx_dark_echoes', target = 'caster', period = 'cast'}],
		sounddata = {cast = 'magic_effect'},
		patches = [],
		ai_priority = 2
	},
	sc_shatter = {
		code = '',
		name = "",
		description = "",
		damagetype = "earth",
		skilltype = 'spell',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'poison'],
		value = [['caster.damage', '*0.5'], ['caster.damage']],
		damagestat = ['no_stat', '+damage_hp'],
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_poison_permanent', push_value = true})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_earth_strike', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {predamage = 'earth_strike'},
		ai_priority = 1
	},
#	bomb_atk = {
#		code = '',
#		name = "",
#		description = "",
#		damagetype = ['bludgeon','dark'],
#		skilltype = 'skill',
#		userange = "any",
#		targetpattern = 'all',
#		allowedtargets = ['enemy'],
#		keep_target = variables.TARGET_KEEP,
#		reqs = [],
#		tags = ['damage', 'default'],
#		value = ['caster.damage', '*0.8'],
#		cooldown = 0,
#		casteffects = [],
#		repeat = 1,
#		hidden = false,
#		sfx = [],
#		patches = [],
#		ai_priority = 1
#	},
	bomb_cond1 = {
		code = '',
		name = "",
		description = "",
		damagetype = 'fire',
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'empty_target', 'aoe'],
		value = ['caster.damage', '*2'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = true,
		sfx = [{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_zombie_boom', target = 'target_group', period = 'predamage'},
#			{code = 'sfx_explosion', target = 'target_group', period = 'predamage'}
		],
		patches = [],
		sounddata = {cast = 'explosion'},
		not_final = true
	},
	bomb_cond2 = {
		code = '',
		name = "",
		description = "",
		damagetype = 'fire',
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['self'],
		keep_target = variables.TARGET_KEEP,
		next_target = variables.NT_ANY,
		reqs = [],
		tags = ['damage', 'empty_target', 'aoe'],
		value = ['caster.damage', '*3'],
		damagestat = 'no_stat',
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_suicide', push_value = true})],
		repeat = 1,
		hidden = true,
		sfx = [{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_zombie_boom', target = 'target_group', period = 'predamage'},
#			{code = 'sfx_explosion', target = 'target_group', period = 'predamage'}
			],
		patches = [],
		sounddata = {cast = 'explosion'},
		not_final = true
	},
	f_heal = {
		code = '',
		name = "",
		description = "",
		damagetype = "light",
		skilltype = 'spell',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['ally', 'self'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['heal'],
		value = ['caster.damage', '*1.5'],
		damagestat = '-damage_hp',
		cooldown = 1,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_soul_prot', target = 'target', period = 'predamage', flip_h = true},
			{code = 'anim_attack', target = 'caster', period = 'cast'},],
		patches = [],
		sounddata = {cast = 'renew'},
		ai_priority = 0.5
	},
	c_heal = {
		code = '',
		name = "",
		description = "",
		damagetype = "light",
		skilltype = 'spell',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['ally', 'self'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['heal'],
		value = ['caster.damage', '*0.5'],
		damagestat = '-damage_hp',
		cooldown = 1,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_cast', target = 'caster', period = 'cast'},
		{code = 'sfx_soul_prot', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {cast = 'renew'},
		ai_priority = 0.5
	},
	poison_spit = {
		code = '',
		name = "",
		description = "",
		damagetype = "water",
		skilltype = 'spell',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'poison'],
		value = [['caster.damage', '*0.4'], ['caster.damage', '*0.8']],
		damagestat = ['no_stat', '+damage_hp'],
		cooldown = 2,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_poison', push_value = true})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_poison_spit', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {cast = 'deluge'},
		ai_priority = 1
	},
	poison_breath = {
		code = '',
		name = "",
		description = "",
		damagetype = "dark",
		skilltype = 'spell',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'poison', 'aoe'],
		value = [['caster.damage', '*0.4'], ['caster.damage', '*0.5']],
		damagestat = ['no_stat', '+damage_hp'],
		cooldown = 2,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_poison', push_value = true, chance = 0.25})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_pale_mist', target = 'target', period = 'predamage', flip_h = true},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'},],
		sounddata = {cast = 'zombi at'},
		patches = [],
		ai_priority = 0.3
	},
	fire_breath = {
		code = '',
		name = "",
		description = "",
		damagetype = "fire",
		skilltype = 'spell',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'burn', 'aoe'],
		value = [['caster.damage'], ['caster.damage', '*0.5']], 
		damagestat = ['no_stat', '+damage_hp'],
		cooldown = 2, 
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_burn', push_value = true, chance = 0.33})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_firepunch', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {cast = 'firebolt'},
		ai_priority = 0.5
	},
	fire_breath_drag_boss = {
		code = '',
		name = "",
		description = "",
		damagetype = "fire",
		skilltype = 'spell',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'burn', 'aoe'],
		value = [['caster.damage'], ['caster.damage', '*0.5']],
		damagestat = ['no_stat', '+damage_hp'],
		cooldown = 2, 
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_burn', push_value = true, chance = 0.33})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_cast', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_firepunch', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {cast = 'dragon cast boss'},
		ai_priority = 1
	},
	roar = {
		code = '',
		name = "",
		description = "",
		damagetype = "air",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'aoe'],
		value = [['caster.damage', '*0.5']],
		cooldown = 2,
		casteffects = [Effectdata.rebuild_template({effect = 'e_intimidate', chance = 0.5})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_roar', target = 'target', period = 'predamage', flip_h = true}
		],
		patches = [],
		sounddata = {cast = 'shockwave'},
		ai_priority = 1
	},
	guard = {
		code = '',
		name = "",
		description = "",
		damagetype = "light",
		skilltype = 'spell',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['ally'],
		keep_target = variables.TARGET_KEEP,
		repeat = 1,
		reqs = [],
		tags = ['buff'],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 1,
		chance = 100,
		evade = 0,
		casteffects = [ 'e_s_def'],
		hidden = false,
		sfx = [{code = 'sfx_shield_up', target = 'target', period = 'predamage'},
			{code = 'anim_attack', target = 'caster', period = 'cast'}],
		sounddata = {cast = 'defend'},
		patches = [],
		ai_priority = 2
	},
	tail_swipe = {
		code = '',
		name = "",
		description = "",
		damagetype = "bludgeon",
		skilltype = 'skill',
		userange = "melee",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_NOKEEP,
		next_target = variables.NT_ANY,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage', '*0.7'],
		cooldown = 2,
		casteffects = [Effectdata.rebuild_template({effect = 'e_stun', duration = 1, chance = 0.4})],
		repeat = 2,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'effected'},
			{code = 'sfx_tail_swipe', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {predamage = 'punch'},
		ai_priority = 1,
#		follow_up = 'tail_swipe1'
	},
#	tail_swipe1 = { #use as template
#		code = 'tail_swipe',
#		name = "",
#		description = "",
#		icon = load("res://assets/images/iconsskills/defaultattack.png"),
#		damagetype = "bludgeon",#not in file
#		skilltype = 'skill',
#		userange = "melee",
#		targetpattern = 'single',
#		allowedtargets = ['enemy'],
#		keep_target = variables.TARGET_NOKEEP,
#		next_target = variables.NT_ANY,
#		reqs = [],
#		tags = ['damage'],
#		value = ['caster.damage', '*0.7'],
#		cooldown = 2,
#		casteffects = [Effectdata.rebuild_template({effect = 'e_stun', duration = 1, chance = 0.4})],
#		repeat = 1,
#		hidden = false,
#		sfx = [],
##		sfxcaster = null,
##		sfxtarget = null,
#		patches = [],
#		ai_priority = 1,
#		not_final = true
#	},
	waterspray = {
		code = '',
		name = "",
		description = "",
		damagetype = "water",
		skilltype = 'spell',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'dispel'],
		value = [['caster.damage', '*1.2']],
		cooldown = 1,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_cleanse'})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_deluge', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {cast = 'big_wave'},
		ai_priority = 1
	},
	heavystrike = {
		code = '',
		name = "",
		description = "",
		damagetype = "bludgeon",
		skilltype = 'skill',
		userange = "melee",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'default'],
		value = ['caster.damage', '*3'],
		cooldown = 1,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_heavystrike', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {predamage = 'punch'},
		ai_priority = 1
	},
	impale = {
		code = '',
		name = "",
		description = "",
		damagetype = "pierce",
		skilltype = 'skill',
		userange = "melee",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'bleed'],
		value = [['caster.damage', '*0.8'], ['caster.damage', '*1.5']],
		damagestat = ['no_stat', '+damage_hp'],
		cooldown = 1,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_bleed', push_value = true, chance = 0.5})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_impale', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {predamage = 'lunge'},
		ai_priority = 1
	},
	an_attack = {
		code = '',
		name = "",
		description = "",
		damagetype = ['water','air'],
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'default'],
		value = ['caster.damage'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'}],
		patches = [],
		sounddata = {predamage = 'weapon'},#postdamage = 'bodyhitsound'
		ai_priority = 1
	},
	an_charm = {
		code = '',
		name = "",
		description = "",
		damagetype = "neutral",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEPFIRST,
		next_target = variables.NT_ANY_NOREPEAT,
		reqs = [],
		tags = ['damage', 'stun'],
		value = ['caster.damage', '*0.7'],
		cooldown = 3,
		casteffects = [Effectdata.rebuild_template({effect = 'e_stun', duration = 2})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_charm', target = 'target', period = 'predamage'},
			{code = 'anim_cast', target = 'caster', period = 'cast'}],
		patches = [],
		sounddata = {predamage = 'charm'},
		ai_priority = 1
	},
	an_summon = {
		code = '',
		name = "",
		description = "",
		damagetype = "summon",
		skilltype = 'spell',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['self'],
		keep_target = variables.TARGET_KEEP,
		reqs = [{type = 'stats', stat = 'ai_spec', operant = 'lt', value = 4}],
		tags = ['summon'],
		value = ['bigdemon', [2, 3]],
		repeat = 1,
		cooldown = 4,
		casteffects = [],
		hidden = false,
		sfx = [{code = 'anim_cast', target = 'caster', period = 'cast'},
			{code = 'sfx_dark_echoes', target = 'caster', period = 'cast'}],
		sounddata = {cast = 'magic_effect'},
		patches = [],
		ai_priority = 1
	},
	an_poison_mist = {
		code = '',
		name = "",
		description = "",
		damagetype = "water",
		skilltype = 'spell',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'poison', 'aoe'],
		value = [['caster.damage', '*0.4'], ['caster.damage', '*0.5']],
		damagestat = ['no_stat', '+damage_hp'],
		cooldown = 1,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_poison_water', push_value = true})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'sfx_pale_mist', target = 'target', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'anim_cast', target = 'caster', period = 'cast'}],
		patches = [],
		sounddata = {predamage = 'pale mist'},
		ai_priority = 1
	},
	an_light_2_rand = {
		code = '',
		name = "",
		description = "",
		damagetype = "air",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_NOKEEP,
		next_target = variables.NT_ANY,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage', '*0.8'],
		cooldown = 0,
		casteffects = [],
		repeat = 2,
		hidden = false,
		sfx = [{code = 'anim_cast', target = 'caster', period = 'cast'},
			{code = 'sfx_gustofwind', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_target_fight_lightning_sq', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {predamage = 'purge'},
		ai_priority = 0.7
	},
	de_attack = {
		code = '',
		name = "",
		description = "",
		damagetype = ['fire','slash'],
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'}],
		patches = [],
		sounddata = {predamage = 'weapon'},
		ai_priority = 1
	},
	dm_storm = {
		code = '',
		name = "",
		description = "",
		damagetype = ['dark'],
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage', '*1.1'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_cast', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_AOE_fight_blacklightning_storm_sq', target = 'target_group', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'magic_effect'},
		ai_priority = 1
	},
	dm_fire = {
		code = '',
		name = "",
		description = "",
		damagetype = "fire",
		skilltype = 'spell',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'burn', 'aoe'],
		value = [['caster.damage', '*0.4'], ['caster.damage', '*0.9']],
		damagestat = ['no_stat', '+damage_hp'],
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_burn', push_value = true})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_cast', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_explosion', target = 'target_group', period = 'postcast'}],
		patches = [],
		sounddata = {cast = 'explosion'},
		ai_priority = 1
	},
	dm_poison_spike = {
		code = '',
		name = "",
		description = "",
		damagetype = "earth",
		skilltype = 'spell',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage', 'poison', 'aoe'],
		value = [['caster.damage', '*0.4'], ['caster.damage', '*1.5']],
		damagestat = ['no_stat', '+damage_hp'],
		cooldown = 1,
		casteffects = [Effectdata.rebuild_template({effect = 'e_s_poison_water', push_value = true})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_earth_strike', target = 'target', period = 'predamage', flip_h = true}],
		patches = [],
		sounddata = {predamage = 'earth_strike'},
		ai_priority = 1
	},
	dm_bomb = {
		code = '',
		name = "",
		description = "",
		damagetype = "light",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEPFIRST,
		next_target = variables.NT_ANY_NOREPEAT,
		reqs = [],
		tags = ['damage', 'stun'],
		value = ['caster.damage'],
		cooldown = 2,
		casteffects = [Effectdata.rebuild_template({effect = 'e_stun', duration = 2})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_attack', target = 'caster', period = 'cast'},
			{code = 'sfx_shockwave', target = 'target', period = 'predamage', flip_h = true},
			{code = 'anim_hit', target = 'target', period = 'postdamage'}],
		patches = [],
		sounddata = {predamage = 'smash'},
		ai_priority = 1
	},
	dm_nova = {
		code = '',
		name = "",
		description = "",
		damagetype = 'light',
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage', '*1.1'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_cast', target = 'caster', period = 'cast'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'},
			{code = 'sfx_AOE_fight_liht_ex_sq', target = 'target_group', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'magic_effect'},
		ai_priority = 1
	},
	dm_form = {
		code = '',
		name = '',
		description = '',
		damagetype = "light",
		skilltype = 'skill',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['self'],
		keep_target = variables.TARGET_KEEPFIRST,
		reqs = [],
		tags = ['instant'],
		value = ['0'],
		cooldown = 2,
		damagestat = 'no_stat',
		casteffects = ['e_dim_resists'],
		hidden = false,
		sfx = [{code = 'anim_cast', target = 'caster', period = 'cast'},
			{code = 'sfx_sanctuary', target = 'target', period = 'predamage'}],
		sounddata = {predamage = 'heal'},
		ai_priority = 10,
	},
	
	
	
	#--------------------------items--------------------------
	item_heal_1_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/carrot.png"),
		damagetype = "light",
		skilltype = 'item',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['ally', 'self'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['heal'],
		value = ['500'],
		damagestat = '-damage_hp',
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_soul_prot', target = 'target', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'renew'}
	},
	item_heal_2_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/Morsel.png"),
		damagetype = "light",
		skilltype = 'item',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['ally', 'self'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['heal'],
		value = ['2500'],
		damagestat = '-damage_hp',
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_soul_prot', target = 'target', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'renew'}
	},
	item_heal_3_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/meat2.png"),
		damagetype = "light",
		skilltype = 'item',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['ally', 'self'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['heal'],
		value = ['10000'],
		damagestat = '-damage_hp',
		cooldown = 0,
		casteffects = ['e_s_dispel'],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_soul_prot', target = 'target', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'renew'}
	},
	item_heal_aoe_1_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/shroom.png"),
		damagetype = "light",
		skilltype = 'item',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['ally', 'self'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['heal'],
		value = ['250'],
		damagestat = '-damage_hp',
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_soul_prot', target = 'target', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'renew'}
	},
	item_heal_aoe_2_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/leaf.png"),
		damagetype = "light",
		skilltype = 'item',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['ally', 'self'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['heal'],
		value = ['1250'],
		damagestat = '-damage_hp',
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_soul_prot', target = 'target', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'renew'}
	},
	item_heal_aoe_3_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/flower.png"),
		damagetype = "light",
		skilltype = 'item',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['ally', 'self'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['heal'],
		value = ['5000'],
		damagestat = '-damage_hp',
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_soul_prot', target = 'target', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'renew'}
	},
	item_dispel_1_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/apple.png"),
		damagetype = "light",
		skilltype = 'item',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['ally', 'self'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['heal'],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 0,
		casteffects = ['e_s_dispel'],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_dispel', target = 'target', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'dispel'}
	},
	item_dispel_2_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/apple2.png"),
		damagetype = "light",
		skilltype = 'item',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['ally', 'self'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['heal'],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 0,
		casteffects = ['e_s_dispel'],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_dispel', target = 'target', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'dispel'}
	},
	item_res_1_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/item_res.png"),
		damagetype = "light",
		skilltype = 'item',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['dead'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['resurrect'],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_i_resurrect20'})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_resto', target = 'target', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'restoration'}
	},
	item_res_2_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/item_res3.png"),
		damagetype = "light",
		skilltype = 'item',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['dead'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['resurrect'],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_i_resurrect100'})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_resto', target = 'target', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'restoration'}
	},
	item_res_3_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/item_res2.png"),
		damagetype = "light",
		skilltype = 'item',
		userange = "any",
		targetpattern = 'dead',
		allowedtargets = ['dead'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['resurrect'],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_i_resurrect20'})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_resto', target = 'target', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'restoration'}
	},
	item_res_4_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/item_res4.png"),
		damagetype = "light",
		skilltype = 'item',
		userange = "any",
		targetpattern = 'dead',
		allowedtargets = ['dead'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['shield', 'resurrect'],
		value = ['target.hpmax', '*0.5'],
		damagestat = 'no_stat',
		cooldown = 0,
		casteffects = [
			Effectdata.rebuild_template({effect = 'e_i_resurrect100'}),
			'e_i_barrier4'
		],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_sanctuary', target = 'target', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'sanctuary'}
	},
	item_barrier_1_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/feather3.png"),
		damagetype = "light",
		skilltype = 'item',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['self', 'ally'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['shield'],
		value = ['target.hpmax', '*0.25'],
		damagestat = 'no_stat',
		cooldown = 0,
		casteffects = ['e_i_barrier5'],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_barrier', target = 'target', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'barrier2'}
	},
	item_barrier_2_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/feather1.png"),
		damagetype = "light",
		skilltype = 'item',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['self', 'ally'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['shield'],
		value = ['target.hpmax', '*1.5'],
		damagestat = 'no_stat',
		cooldown = 0,
		casteffects = ['e_i_barrier4'],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_barrier', target = 'target', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'barrier2'}
	},
	item_barrier_3_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/feather2.png"),
		damagetype = "light",
		skilltype = 'item',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['self', 'ally'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['shield'],
		value = ['target.hpmax'],
		damagestat = 'no_stat',
		cooldown = 0,
		casteffects = ['e_i_barrier5'],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_barrier', target = 'target', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'barrier2'}
	},
	item_damage_1_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/bomb.png"),
		damagetype = "magic",#not sure
		skilltype = 'item',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage', '*1.5'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_shockwave', target = 'target', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'}],
		patches = [], 
		ai_priority = 1,
		sounddata = {cast = 'explosion'}
	},
	item_damage_2_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/bomb_adv.png"),
		damagetype = "magic",#not sure
		skilltype = 'item',
		userange = "any",
		targetpattern = 'all',
		allowedtargets = ['enemy'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['damage'],
		value = ['caster.damage', '*1.5'],
		cooldown = 0,
		casteffects = [],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_shockwave', target = 'target', period = 'predamage'},
			{code = 'anim_hit', target = 'target', period = 'postdamage'}],
		patches = [], 
		ai_priority = 1,
		sounddata = {cast = 'explosion'}
	},
	item_buff_atk_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/scroll_sword.png"),
		damagetype = "light",
		skilltype = 'item',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['self', 'ally'],
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['buff'],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_i_atkup'})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_fencing', target = 'target', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'sword mastery'}
	},
	item_buff_def_effect = {
		code = '',
		name = "",
		description = "",
		icon = load("res://assets/images/iconsitems/scroll_shield.png"),
		damagetype = "light",
		skilltype = 'item',
		userange = "any",
		targetpattern = 'single',
		allowedtargets = ['self', 'ally'], #or just self
		keep_target = variables.TARGET_KEEP,
		reqs = [],
		tags = ['buff'],
		value = ['0'],
		damagestat = 'no_stat',
		cooldown = 0,
		casteffects = [Effectdata.rebuild_template({effect = 'e_i_defup'})],
		repeat = 1,
		hidden = false,
		sfx = [{code = 'anim_use', target = 'caster', period = 'cast'},
			{code = 'sfx_shield_up', target = 'target', period = 'predamage'}],
		patches = [],
		sounddata = {cast = 'nature_blessing'}
	},
}


var patches = {
	p_base_erika = {
		sfx = {type = 'replace', value = [{code = 'anim_attack', target = 'caster', period = 'cast'},{code = 'anim_hit', target = 'target', period = 'postdamage'}, {code = 'sfx_arrow_shot', target = 'target', period = 'predamage'}]}
	},
	p_base_rose = {
		sfx = {type = 'replace', value = [{code = 'anim_attack', target = 'caster', period = 'cast'},{code = 'anim_hit', target = 'target', period = 'postdamage'}, {code = 'sfx_iola_swipe', target = 'target', period = 'predamage'}]}
	},
	p_fencing_1 = {
		casteffects = {type = 'append', value = ['e_fen_addrep']},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ARRON1', effect = 'WEAPON_ARRON1_EFFECT1'}]}
	},
	p_fencing_2 = {
		casteffects = {type = 'append', value = ['e_fen_addrep2']},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ARRON1', effect = 'WEAPON_ARRON1_EFFECT1_4'}]}
	},
	p_fencing_3 = {
		casteffects = {type = 'append', value = ['e_fen_debuf']},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ARRON2', effect = 'WEAPON_ARRON2_EFFECT1'}]}
	},
	p_fencing_4 = {
		casteffects = {type = 'append', value = ['e_fen_debuf2']},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ARRON2', effect = 'WEAPON_ARRON2_EFFECT1_4'}]}
	},
	p_lunge = {
		targetpattern = {type = 'set', value = 'row'},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ARRON2', effect = 'WEAPON_ARRON2_EFFECT3'}]}
	},
	p_swift_1 = {
		custom_duration = {type = 'set', value = 2},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ARRON1', effect = 'WEAPON_ARRON1_EFFECT3'}]}
	},
	p_parry_1 = {
		custom_duration = {type = 'add', value = 1},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ARRON2', effect = 'WEAPON_ARRON2_EFFECT2'}]}
	},
	p_swm_1 = {
		custom_duration = {type = 'add', value = 1},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ARRON1', effect = 'WEAPON_ARRON1_EFFECT2'}]}
	},
	p_term_1 = {
		casteffects = {type = 'replace', value = ['e_s_termination1']},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ARRON1', effect = 'WEAPON_ARRON1_EFFECT4'}]}
	},
	p_smoke_screen = {
		casteffects = {type = 'append', value = [Effectdata.rebuild_template({effect = 'e_s_smoke_patch'})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ARRON2', effect = 'WEAPON_ARRON2_EFFECT4'}]}
	},
	p_dispel = {
		targetpattern = {type = 'set', value = 'all'},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ROSE2', effect = 'WEAPON_ROSE2_EFFECT2'}]}
	},
	p_fbolt_1 = {
		value = {type = 'replace', value = [['caster.damage'], ['caster.damage']]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ROSE1', effect = 'WEAPON_ROSE1_EFFECT1'}]}
	},
	p_fbolt_2 = {
		value = {type = 'replace', value = [['caster.damage', '*1.5'], ['caster.damage']]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ROSE1', effect = 'WEAPON_ROSE1_EFFECT1_4'}]}
	},
	p_flash_1 = {
		casteffects = {type = 'append', value = [Effectdata.rebuild_template({effect = 'e_stun', chance = 0.1, duration = 1})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ROSE1', effect = 'WEAPON_ROSE1_EFFECT3'}]}
	},
	p_flash_2 = {
		casteffects = {type = 'append', value = [Effectdata.rebuild_template({effect = 'e_stun', chance = 0.15, duration = 1})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ROSE1', effect = 'WEAPON_ROSE1_EFFECT3_4'}]}
	},
	p_deluge = {
		targetpattern = {type = 'set', value = 'all'},
		chance = {type = 'set', value = 100},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ROSE2', effect = 'WEAPON_ROSE2_EFFECT3'}]}
	},
	p_renew_1 = {
		casteffects = {type = 'append', value = [Effectdata.rebuild_template({effect = 'e_s_renew1'})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ROSE2', effect = 'WEAPON_ROSE2_EFFECT1'}]}
	},
	p_renew_2 = {
		casteffects = {type = 'append', value = [Effectdata.rebuild_template({effect = 'e_s_renew2'})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ROSE2', effect = 'WEAPON_ROSE2_EFFECT1_4'}]}
	},
	p_explosion = {
		casteffects = {type = 'append', value = ['e_s_explosion']},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ROSE1', effect = 'WEAPON_ROSE1_EFFECT4'}]}
	},
	p_protect = {
		follow_up = {type = 'set', value = 'protect1'},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ROSE2', effect = 'WEAPON_ROSE2_EFFECT4'}]}
	},
	p_qshot_1 = {
		keep_target = {type = 'set', value = variables.TARGET_KEEP},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ERIKA1', effect = 'WEAPON_ERIKA1_EFFECT3'}]}
	},
	p_qshot_2 = {
		repeat = {type = 'add', value = 1},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ERIKA2', effect = 'WEAPON_ERIKA2_EFFECT1'}]}
	},
	p_qshot_3 = {
		repeat = {type = 'add', value = 2},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ERIKA2', effect = 'WEAPON_ERIKA2_EFFECT1_4'}]}
	},
	p_aarrow_1 = {
		casteffects = {type = 'append', value = [Effectdata.rebuild_template({effect = 'e_s_aarrow1', trigger = variables.TR_HIT})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ERIKA1', effect = 'WEAPON_ERIKA1_EFFECT1'}]}
	},
	p_aarrow_2 = {
		casteffects = {type = 'append', value = [Effectdata.rebuild_template({effect = 'e_s_aarrow2', trigger = variables.TR_HIT})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ERIKA1', effect = 'WEAPON_ERIKA1_EFFECT1_4'}]}
	},
	p_farrow_1 = {
		casteffects = {type = 'append', value = [Effectdata.rebuild_template({effect = 'e_s_chill', push_value = true})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ERIKA1', effect = 'WEAPON_ERIKA1_EFFECT2'}]}
	},
	p_arrshower = {
		casteffects = {type = 'append', value = [Effectdata.rebuild_template({effect = 'e_s_arrshower'})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ERIKA2', effect = 'WEAPON_ERIKA2_EFFECT2'}]}
	},
	p_hearts = {
		casteffects = {type = 'append', value = [Effectdata.rebuild_template({effect = 'e_s_hearts'})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ERIKA1', effect = 'WEAPON_ERIKA1_EFFECT4'}]}
	},
	p_charm = {
		casteffects = {type = 'append', value = ['e_s_charm1']},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ERIKA2', effect = 'WEAPON_ERIKA2_EFFECT4'}]}
	},
	p_natbless = {
		tags = {type = 'append', value = ['disabled']},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_ERIKA2', effect = 'WEAPON_ERIKA2_EFFECT3'}]}
	},
	p_combo_1 = {
		casteffects = {type = 'append', value = ['e_t_combo1']},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_EMBER1', effect = 'WEAPON_EMBER1_EFFECT1'}]}
	},
	p_combo_2 = {
		casteffects = {type = 'append', value = ['e_t_combo2']},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_EMBER1', effect = 'WEAPON_EMBER1_EFFECT1_4'}]}
	},
	p_punch_1 = {
		casteffects = {type = 'append', value = ['e_s_firepunch']},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_EMBER1', effect = 'WEAPON_EMBER1_EFFECT2'}]}
	},
	p_shockwave = {
		casteffects = {type = 'append', value = [Effectdata.rebuild_template({effect = 'e_s_shockwave'})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_EMBER2', effect = 'WEAPON_EMBER2_EFFECT2'}]}
	},
	p_defend_1 = {
		cooldown = {type = 'add', value = -1},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_EMBER2', effect = 'WEAPON_EMBER2_EFFECT1'}]}
	},
	p_defend_2 = {
		cooldown = {type = 'add', value = -2},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_EMBER2', effect = 'WEAPON_EMBER2_EFFECT1_4'}]}
	},
	p_dragonprot = {
		value = {type = 'replace', value = ['caster.hpmax', '*0.5']},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_EMBER2', effect = 'WEAPON_EMBER2_EFFECT3'}]}
		#delete with time
#		casteffects = {type = 'replace', value = [Effectdata.rebuild_template({effect = 'e_t_dragonprot1', push_value = true})]}
	},
	p_aegis = {
		casteffects = {type = 'append', value = [Effectdata.rebuild_template({effect = 'e_s_aegis1'})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_EMBER2', effect = 'WEAPON_EMBER2_EFFECT4'}]}
	},
	p_eq = {
		casteffects = {type = 'append', value = [Effectdata.rebuild_template({effect = 'e_stun', chance = 0.2, duration = 1})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_EMBER1', effect = 'WEAPON_EMBER1_EFFECT4'}]}
	},
	p_orb_1 = {
		casteffects = {type = 'append', value = ['e_orb_addrep1']},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_RILU1', effect = 'WEAPON_RILU1_EFFECT1'}]}
	},
	p_orb_2 = {
		casteffects = {type = 'append', value = ['e_orb_addrep2']},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_RILU1', effect = 'WEAPON_RILU1_EFFECT1_4'}]}
	},
	p_mist = {
		casteffects = {type = 'append', value = [Effectdata.rebuild_template({effect = 'e_s_mist'})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_RILU2', effect = 'WEAPON_RILU2_EFFECT3'}]}
	},
	p_ava = {
		casteffects = {type = 'append', value = [Effectdata.rebuild_template({effect = 'e_s_ava'})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_RILU2', effect = 'WEAPON_RILU2_EFFECT2'}]}
	},
	p_thorn = {
		casteffects = {type = 'append', value = [Effectdata.rebuild_template({effect = 'e_add_s1'})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_RILU1', effect = 'WEAPON_RILU1_EFFECT2'}]}
	},
	p_echo_1 = {
		value = {type = 'replace', value = [['caster.hpmax','*0.5'],['caster.damage','*0.6']],},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_RILU2', effect = 'WEAPON_RILU2_EFFECT1'}]}
	},
	p_echo_2 = {
		value = {type = 'replace', value = [['caster.hpmax','*0.75'],['caster.damage','*0.6']],},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_RILU2', effect = 'WEAPON_RILU2_EFFECT1_4'}]}
	},
	p_resto = {
		value = {type = 'replace', value = ['caster.hpmax','*0.4'],},
		casteffects = {type = 'append', value = ['e_pay_soul']},
		reqs = {type = 'replace', value = [{type = 'stats', stat = 'alt_mana', operant = 'gte', value = 2}]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_RILU1', effect = 'WEAPON_RILU1_EFFECT3'}]}
	},
	p_beam = {
		value = {type = 'replace', value = ['caster.damage', '*', ['caster.alt_mana', '*0.1', '+0.9'],'*1.5']},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_RILU1', effect = 'WEAPON_RILU1_EFFECT4'}]}
	},
	p_bless_1 = {
		cooldown = {type = 'add', value = -1},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_IOLA1', effect = 'WEAPON_IOLA1_EFFECT1'}]}
	},
	p_bless_2 = {
		cooldown = {type = 'add', value = -2},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_IOLA1', effect = 'WEAPON_IOLA1_EFFECT1_4'}]}
	},
	p_gust = {
		casteffects = {type = 'replace', value = [Effectdata.rebuild_template({effect = 'e_s_gust2', chance = 0.8})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_IOLA2', effect = 'WEAPON_IOLA2_EFFECT2'}]}
	},
	p_smash = {
		casteffects = {type = 'replace', value = [Effectdata.rebuild_template({effect = 'e_stun', duration = 1})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_IOLA1', effect = 'WEAPON_IOLA1_EFFECT2'}]}
	},
	p_clean_1 = {
		targetpattern = {type = 'set', value = 'line'},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_IOLA2', effect = 'WEAPON_IOLA2_EFFECT3'}]}
	},
	p_clean_2 = {
		casteffects = {type = 'replace', value = [Effectdata.rebuild_template({effect = 'e_s_cleanse'}), Effectdata.rebuild_template({effect = 'e_s_burn_onget', push_value = true})]},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_IOLA1', effect = 'WEAPON_IOLA1_EFFECT3'}]}
	},
	p_barrier = {
		repeat = {type = 'add', value = 1},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_IOLA2', effect = 'WEAPON_IOLA2_EFFECT1'}]}
	},
	p_barrier_all = {
		targetpattern = {type = 'set', value = 'all'},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_IOLA2', effect = 'WEAPON_IOLA2_EFFECT1_4'}]}
	},
	p_sanct = {
		value = {type = 'replace', value = ['caster.hpmax','*0.7']},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_IOLA1', effect = 'WEAPON_IOLA1_EFFECT4'}]}
	},
	p_purge = {
		value = {type = 'replace', value = ['caster.damage','*2.5']},
		damagestat = {type = 'set', value = '+damage_hp'},
		damagetype = {type = 'set', value = 'light'},
		description_patch = {type = 'append',
			value = [{weapon = 'WEAPON_IOLA2', effect = 'WEAPON_IOLA2_EFFECT4'}]}
	}
}

func patch_skill(skill_id, unit):
	var template = skilllist[skill_id].duplicate(true)
	if template.has('patches'):
		for p in template.patches:
			if unit.process_check(p.conditions):
				var tmp = patches[p.patch]
				for key in tmp:
					match tmp[key].type:
						'add': template[key] += tmp[key].value
						'set': template[key] = tmp[key].value
						'replace': template[key] = tmp[key].value.duplicate()
						'merge': #dicts
							for k in tmp[key].value:
								template[key][k] = tmp[key].value[k]
						'append': #arrays
							for i in tmp[key].value:
								template[key].push_back(i)
	return template

func get_description(patched_skill :Dictionary) -> String:
	var desc_text = tr(patched_skill.description)
	assert(patched_skill.has('description_patch'), "skill '%s' has no description_patch, but trying to show description" % patched_skill.code)
	for add_desc in patched_skill.description_patch:
		desc_text += "\n%s: %s" % [tr(add_desc.weapon), tr(add_desc.effect)]
	return desc_text

func _ready():
	for i in skilllist:
		skilllist[i].code = i #do not touch
		skilllist[i].name = "SKILL" + i.to_upper()
		skilllist[i].description = "SKILL" + i.to_upper() + "DESCRIPT"
		if skilllist[i].has('sounddata'):
			var tdata = skilllist[i].sounddata
			for period in tdata:
				if period == 'predamage' and tdata[period] == "weapon":
					continue
				if period == 'postdamage' and (tdata[period] == "bodyhitsound" or tdata[period] == "bodyarmor"):
					continue
				resources.preload_res("sound/%s" % tdata[period])

func get_true_damagetype(damagetype, char_id) ->String:
	if damagetype is String:
		return calc_damagetype(damagetype, char_id)
	elif damagetype is Array:
		print("ATTENTION! Skill for UI has numerous damagetypes!!!")
		return calc_damagetype(damagetype[0], char_id)
	else:
		return ""

func calc_damagetype(damagetype :String, char_id) ->String:
	var true_damagetype :String
	if damagetype == 'weapon':
		true_damagetype = state.heroes[char_id].get_weapon_damagetype()
	else:
		true_damagetype = damagetype
	if !variables.resistlist.has(true_damagetype):
		return ""
	return true_damagetype

static func append_array_unique(arr :Array, app_arr :Array):#modifies arr!
	for new_entry in app_arr:
		if !arr.has(new_entry):
			arr.append(new_entry)

func get_resists_applicable(skill_id :String, char_id :String) ->Array:
	var resists = []
	var skill = patch_skill(skill_id, state.heroes[char_id])
	for resist_type in variables.resistlist:#there is idle run for 'damage' resist type, but I leave it for unification purpose
		if skill.damagetype is String:
			if skill.damagetype == resist_type:#weapon-damagetype goes separately as item
				resists.append(resist_type)
				continue
		elif skill.damagetype is Array:
			if skill.damagetype.has(resist_type):
				resists.append(resist_type)
				continue
		else:
			assert(false, "damagetype of skill %s has unexpected type" % skill_id)
	
	if skill.has('casteffects'):
		for effect in skill.casteffects:
			append_array_unique(resists, Effectdata.get_resists_applicable(effect))
	
	if skill.has('follow_up'):
		append_array_unique(resists, get_resists_applicable(skill.follow_up, char_id))
	
	return resists


#Here is a sort of a guide for effects system (as it is f%#$ complicated):
#First thing - dictionaries in skilllist here are templates. True skills to use are 'S_Skill' objects, created with this templates.
#'casteffects' in skill-template is a list of effect-templates.
#If it's string, go for corresponding dictionary to 'Effectdata' singleton, .
#rebuild_template() creates local trigger-type effect-template dictionary with sub_effect from arguments.
#When S_Skill-object actually created, it creates effect-objects of classes corresponding to 'type' in effect-templates of casteffects.
#For example, trigger-type effect-template makes 'triggered_effect' class object.
#Then, effect-object put into 'effects_pool' singleton, and referred by id wherever it's needed.
#This "first class" effect-objects are tied to parent S_Skill-objects. Mostly it's trigger-type effects,
#so when triggered, they creates new effect-objects from templetes in there 'sub_effects' parameter.
#It's goes mostly in same manner, but this "sub class" effect-objects are tied to there parent effect-object, instead of the skill.
#The most complicated thing is: any effect-objects can have further sub_effects and this can grow to a big tree.
#Effect-classes are very different, can apply to different game objects and have specific rules.
#All-in-all: every active effect - is an object in 'effects_pool' singleton. Effect can be appled to certain game object (like skill or character)
#and be activated by it with process_event() function. Also most effects are tied to it's parent and can influence it.
#There are effects, who's purpose is only to control there sub_effects or parent-effect. And there are effects, wich created for a short instant action.
#"Leaf" effects of a "tree", wich has no sub_effects and/or are actually effecting there appled object, seems to have 'atomic' parameter filled.
